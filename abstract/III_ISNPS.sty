% This style file requires at least LaTeX version 2e
\NeedsTeXFormat{LaTeX2e}
\DeclareOption*{\PassOptionsToPackage{\CurrentOption}{inputenc}}
\ProcessOptions\relax
\RequirePackage{inputenc}

% Name of style, date it was last updated, purpose and author.
\ProvidesPackage{II_ISNPS}[2015/05/20 III ISNPS Conference abstract style. Original author: Eduardo Garc\`{i}a-Portugu\`es based on the abstract style of METMA VI, Enhanced by Pierre-Andr\'e Cornillon]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%               CONTENTS OF THE ABSTRACT STYLE                 %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Packages
\RequirePackage[T1]{fontenc}
\RequirePackage{amsmath,amsfonts,amssymb,bm}
\RequirePackage{url}
\RequirePackage[usenames,dvipsnames]{xcolor}
\RequirePackage{geometry}
%%%%%%%%% dimensions %%%%%%%%%%%%%%%%%%%%%%%%%%%%
\geometry{paperwidth=210mm,paperheight=297mm,top=30mm, bottom=30mm, left=25mm, right=25mm}
\RequirePackage{fancyhdr}
%\RequirePackage[natbibapa]{apacite}
\RequirePackage{natbib}
\RequirePackage{pgf,pgffor}

\makeatletter

% Running title and authors, address
\newcommand{\titlerunning}[1]{\def\@titlerunning{#1}}
\newcommand{\authorrunning}[1]{\def\@authorrunning{#1}}
\newcommand{\address}[1]{\def\@address{#1}}
% Headings and foots
\setlength{\headheight}{15pt}
\pagestyle{fancy}\fancypagestyle{plain}
\AtBeginDocument{\lhead{\textit{\@authorrunning}}\chead{}\rhead{\textit{\@titlerunning}}}
\renewcommand{\headrulewidth}{.5pt}
\lfoot{\textbf{III International Society of NonParametric Statistics Conference}}\cfoot{}\rfoot{\thepage}
\renewcommand{\footrulewidth}{.5pt}
% Abstract and keywords
\def\@abstract{\normalsize\textbf{Abstract. }} \def\end@abstract{\par}
\def\@keywords{\normalsize\textbf{Keywords. }} \def\end@keywords{\par}
\newtoks\abstract \newtoks\keywords
\def\cleararticleinfo{\global\abstract={} \global\keywords={}}
% Make title
\newcommand{\colorline}{\foreach \n in {26,...,75}{\textcolor{Cerulean!\n!white}{\rule{0.02\textwidth}{3pt}}}}
\newcommand{\revcolorline}{\foreach \n in {26,...,75}{\textcolor{white!\n!Cerulean}{\rule{0.02\textwidth}{3pt}}}}
\renewcommand{\@maketitle}{
\newsavebox{\foo}
\savebox{\foo}{
\begin{minipage}[t]{15.7cm}
	% Title and authors
	\par\vspace{0.5em}\colorline\par\vspace{-0.5em}
	\begin{minipage}[c][4cm][c]{15.5cm}
		\begin{center}
		\Large\bfseries\@title
		\par\vspace{1em}
		\normalfont\normalsize\noindent\@author
		\vspace{-0.5em}
		\end{center}
	\end{minipage}
	\par\vspace{-0.5em}\revcolorline\par
	% Affiliations
	\par\vspace{1em}\itshape\small
	\@address
	\par\vspace{1em}\noindent\rule{\linewidth}{.5pt}
	% Abstract and keywords
	\par\vspace{1em}
	\begin{@abstract}\the\abstract\end{@abstract}
	\par\vspace{1em}
	\begin{@keywords}\the\keywords\end{@keywords}
	\par\vspace{1em}\noindent\rule{\linewidth}{.5pt}
\end{minipage}}
\par\noindent\usebox{\foo}\vspace{-0.25cm}}
% Bibliography
\renewenvironment{thebibliography}[1]
     {\section*{\normalsize\refname}
      \vspace{-0.5cm}
      \small\@mkboth{\MakeUppercase\refname}{\MakeUppercase\refname}
      \list{\@biblabel{\@arabic\c@enumiv}}
           {\settowidth\labelwidth{\@biblabel{#1}}
            \leftmargin\labelwidth
            \advance\leftmargin\labelsep
            \@openbib@code
            \usecounter{enumiv}%
            \let\p@enumiv\@empty
            \renewcommand\theenumiv{\@arabic\c@enumiv}}
      \sloppy
      \clubpenalty4000
      \@clubpenalty \clubpenalty
      \widowpenalty4000%
      \sfcode`\.\@m}
     {\def\@noitemerr
       {\@latex@warning{Empty `thebibliography' environment}}
      \endlist}
\setlength{\parskip}{\baselineskip}

\makeatother

\endinput
